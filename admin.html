<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìš´ì˜ì§„ ë³‘ë ¥ ì¡°íšŒ</title>
<style>
body {
  background:#020617;
  color:#e5e7eb;
  font-family:Pretendard, Arial;
  padding:30px;
}
table {
  width:100%;
  border-collapse:collapse;
}
th,td {
  padding:12px;
  border-bottom:1px solid #334155;
  text-align:center;
}
th {
  color:#38bdf8;
  cursor:pointer;
}
</style>
</head>

<body>
<h2>ğŸ“Š ìš´ì˜ì§„ ë³‘ë ¥ í˜„í™©</h2>
<table id="table"></table>

<script>
const API = 'https://script.google.com/macros/s/AKfycbw8RlD6If-ULAEMz3Fl0C_AjslH2ryLOdT7234bAJHJl9RqY4tKraMfsUnEF8_ujCTK/exec';
let asc = true;

function formatDate(v){
  const d = new Date(v);
  return `${d.getMonth()+1}/${d.getDate()} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}`;
}

fetch(API).then(r=>r.json()).then(render);

function render(rows){
  table.innerHTML =
  `<tr>
    <th onclick="sort(0)">ë‹‰ë„¤ì„</th>
    <th onclick="sort(1)">ì°½ë³‘</th>
    <th onclick="sort(2)">ê¶ë³‘</th>
    <th onclick="sort(3)">ë°©íŒ¨ë³‘</th>
    <th onclick="sort(4)">ê¸°ë³‘</th>
    <th onclick="sort(5)">ë³‘ë¶€</th>
    <th onclick="sort(6)">ì—…ë°ì´íŠ¸</th>
  </tr>` +
  rows.map(r =>
    `<tr>
      <td>${r[0]}</td>
      <td>${r[1]}</td>
      <td>${r[2]}</td>
      <td>${r[3]}</td>
      <td>${r[4]}</td>
      <td>${r[5]}</td>
      <td>${formatDate(r[6])}</td>
    </tr>`
  ).join('');
}

function sort(i){
  fetch(API).then(r=>r.json()).then(rows=>{
    rows.sort((a,b)=> asc ? a[i]-b[i] : b[i]-a[i]);
    asc = !asc;
    render(rows);
  });
}
</script>
</body>
</html>
