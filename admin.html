<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>ìš´ì˜ì§„ ë³‘ë ¥ ì¡°íšŒ</title>
<style>
body {
  background:#020617;
  color:#e5e7eb;
  font-family:Pretendard, Arial;
  padding:30px;
}
table {
  width:100%;
  border-collapse:collapse;
  background:#020617;
}
th,td {
  padding:12px;
  border-bottom:1px solid #1e293b;
  text-align:center;
}
th {
  background:#1e293b;
  cursor:pointer;
}
</style>
</head>

<body>
<h2>ğŸ“Š í’ìš´ íƒœê³  ë³‘ë ¥í‘œ</h2>
<table id="table"></table>

<script>
const API = 'https://script.google.com/macros/s/AKfycbzxs4xP3Emg53PlNmYItDbxJvytMYGmJrnjHJCPU93xzKrwmrmUMgifBFMiRSv6okw/exec';
let asc = true;

fetch(API).then(r=>r.json()).then(render);

function render(rows){
  table.innerHTML =
  `<tr>
    <th onclick="sort(0)">ë‹‰ë„¤ì„</th>
    <th onclick="sort(1)">ì°½ë³‘</th>
    <th onclick="sort(2)">ê¶ë³‘</th>
    <th onclick="sort(3)">ë°©íŒ¨ë³‘</th>
    <th onclick="sort(4)">ê¸°ë³‘</th>
    <th onclick="sort(5)">ë³‘ë¶€</th>
    <th onclick="sort(6)">ì—…ë°ì´íŠ¸</th>
  </tr>` +
  rows.map(r =>
    `<tr>${r.map(c=>`<td>${c}</td>`).join('')}</tr>`
  ).join('');
}

function sort(i){
  fetch(API).then(r=>r.json()).then(rows=>{
    rows.sort((a,b)=>{
      if(a[i]>b[i]) return asc?1:-1;
      if(a[i]<b[i]) return asc?-1:1;
      return 0;
    });
    asc=!asc;
    render(rows);
  });
}
</script>
</body>
</html>


